generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id                 String   @id @unique @db.Uuid
  email              String   @unique
  raw_user_meta_data String   @default("{}")
  created_at         String
  role               role
  devices            device[]
  profile            profile?
}

model profile {
  id              String   @id @unique @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  email           String
  first_name      String
  last_name       String
  created_at      DateTime @default(now())
  company_name    String?
  profile_picture String?
  user            user     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  user_id         String   @unique @db.Uuid
}

model device {
  id            String   @id @unique @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  name          String
  description   String?
  external_code String
  internal_code String
  brand         String
  model         String
  serial_number String
  location      String
  image_url     String
  created_at    DateTime @default(now())
  user_id       String   @db.Uuid
  user          user     @relation(fields: [user_id], references: [id])
  ticket        ticket[]
}

model update {
  id          String   @id @unique @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  title       maintenances
  description String
  created_at  DateTime @default(now())
  ticket_id   String   @db.Uuid
  ticket      ticket   @relation(fields: [ticket_id], references: [id])
}

model ticket {
  id          String   @id @unique @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  maintenance_type     maintenances_type
  update               update[]
  description String?
  created_at  DateTime @default(now())
  device_id   String   @db.Uuid
  device      device  @relation(fields: [device_id], references: [id])
}

enum maintenances {
  MAINTAINING
}

enum maintenances_type {
  PREVENTIVE
  CORRECTIVE
}

enum role {
  CLIENT
  INTERN
  ADMIN
}
