generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id                 String   @id @unique
  email              String   @unique
  raw_user_meta_data String   @default("{}")
  created_at         String
  role               role
  devices            device[]
  profile            profile?
}

model profile {
  id              String   @id @unique @default(dbgenerated("uuid_generate_v4()"))
  email           String
  first_name      String
  last_name       String
  created_at      DateTime @default(now())
  company_name    String?
  profile_picture String?
  user_id         String   @unique
  user            user     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model device {
  id            String   @id @unique @default(dbgenerated("uuid_generate_v4()"))
  name          String
  description   String?
  external_code String
  internal_code String
  brand         String
  model         String
  serial_number String
  location      String
  image_url     String
  created_at    DateTime @default(now())
  user_id       String
  user          user     @relation(fields: [user_id], references: [id])
  maintenance  maintenance[]
}

model maintenance {
  id          String   @id @unique @default(dbgenerated("uuid_generate_v4()"))
  title       maintenances
  type        maintenances_type
  description String
  created_at  DateTime @default(now())
  device_id   String
  device      device   @relation(fields: [device_id], references: [id])
}

enum maintenances {
  NEEDS_MAINTENANCE
  DO_NOT_NEED_MAINTENANCE
  MAINTENANCE_REQUESTED
  MAINTENANCE_ACCEPTED
  MAINTAINING
  MAINTAINED
}

enum maintenances_type {
  PREVENTIVE
  CORRECTIVE
}

enum role {
  CLIENT
  INTERN
  ADMIN
}
